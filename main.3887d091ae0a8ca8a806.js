"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[179],{775:function(e,t,r){var n=r(294),a=r(935),o={TRADES_LIMIT:80,SOCKET_URL:"wss://ws.bitmex.com/realtime",SOCKET_TIMEOUT:5e3,CURRENCY_NAME:{AVAXUSD:"Avalanche",AXSUSD:"Axie Infinity",BNBUSD:"Binance Coin",XBTUSD:"Bitcoin",BCHUSD:"Bitcoin Cash",ADAUSD:"Cardano",LINKUSD:"Chainlink",DOGEUSD:"Dogecoin",EOSUSD:"EOS Token",ETHUSD:"Etherium",LTCUSD:"Litecoin",DOTUSD:"Polkadot",XRPUSD:"Ripple",SOLUSD:"Solana"},DEFAULT_CHARTS:["XBTUSD","DOGEUSD","ETHUSD"],ACTIONS:{SET_TRADES:"SET_TRADES",SET_CHARTS:"SET_CHARTS"}};function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var c,i=!1;function s(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f=o.CURRENCY_NAME,d=o.ACTIONS,p=function(e){for(var t=Object.keys(f),r={active:new Set(e?e.active:o.DEFAULT_CHARTS),currencies:{}},n=0,a=t;n<a.length;n++){var l=a[n];r.currencies[l]={name:f[l],labels:e?s(e.currencies[l].labels):[],data:e?s(e.currencies[l].data):[]}}return r},b=function(e,t){switch(t.type){case d.SET_TRADES:var r=t.payload;if(!Array.isArray(r))return e;var n=p(e);for(var a in r.forEach((function(e){var t=n.currencies[e.symbol].labels,r=n.currencies[e.symbol].data;r[r.length-1]===e.price?t[t.length-1]=new Date(e.timestamp).toLocaleTimeString("it-IT"):(t.push(new Date(e.timestamp).toLocaleTimeString("it-IT")),r.push(e.price))})),n.currencies){var l=n.currencies[a].labels.length;l>o.TRADES_LIMIT&&(n.currencies[a].labels.splice(0,l-o.TRADES_LIMIT),n.currencies[a].data.splice(0,l-o.TRADES_LIMIT))}return n;case d.SET_CHARTS:var c=p(e);return"symbol"in t.payload&&(t.payload.active?c.active.add(t.payload.symbol):c.active.delete(t.payload.symbol)),c;default:throw new Error("from reducer")}},y=p(),h=function(){return y},E=function(e){return function(t){return e({type:o.ACTIONS.SET_TRADES,payload:t})}},v=function(e){return function(t){var r=t.symbol,n=t.active;return e({type:o.ACTIONS.SET_CHARTS,payload:{symbol:r,active:n}})}},S=n.createContext({isWsAlive:!1,trades:y,dispatch:{setTrades:E(h),setCharts:v(h)}});function T(e){var t,r,a=e.children,s=(t=(0,n.useReducer)(b,p()),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],l=!0,c=!1;try{for(r=r.call(e);!(l=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{l||null==r.return||r.return()}finally{if(c)throw a}}return o}}(t,r)||u(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=s[0],f=s[1],d={isWsAlive:function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],l=!0,c=!1;try{for(r=r.call(e);!(l=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{l||null==r.return||r.return()}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),r=t[0],a=t[1];function s(){clearTimeout(c),a(!1),i||(setTimeout(u,o.SOCKET_TIMEOUT),i=!0)}function u(){var t=new WebSocket(o.SOCKET_URL),r=function(){return t.send("ping")};return i=!1,t.onopen=function(){c=setTimeout(r,o.SOCKET_TIMEOUT),a(!0),t.send(JSON.stringify({op:"subscribe",args:Object.keys(o.CURRENCY_NAME).map((function(e){return"trade:".concat(e)}))}))},t.onmessage=function(n){clearTimeout(c),c=setTimeout(r,o.SOCKET_TIMEOUT);try{var a=JSON.parse(n.data);e(a.data)}catch(e){"pong"!==n.data&&(console.error(e),t.close())}},t.onerror=function(e){console.error(e),s()},t.onclose=function(){s()},function(){return t.close()}}return(0,n.useEffect)(u,[]),r}(E(f)),trades:m,dispatch:{setTrades:E(f),setCharts:v(f)}};return n.createElement(S.Provider,{value:d},a)}var g=function(){return(0,n.useContext)(S)};function A(e){var t=e.symbol,r=e.price;return n.createElement("div",{className:"d-flex me-3",key:t},n.createElement("dt",{className:"me-1 text-shadow-primary fw-normal"},t,": "),n.createElement("dd",{className:"top-item-number mb-0 text-shadow-secondary"},r))}var C=n.memo(A,(function(e,t){return e.price===t.price}));function N(){var e=g().trades;return n.createElement("dl",{className:"list-group list-group-horizontal marquee-line"},Object.keys(e.currencies).map((function(t){return n.createElement(C,{symbol:t,price:e.currencies[t].data[e.currencies[t].data.length-1],key:t})})),Object.keys(e.currencies).map((function(t){return n.createElement(C,{symbol:t,price:e.currencies[t].data[e.currencies[t].data.length-1],key:t})})))}function w(){var e=g().isWsAlive;return(0,n.useMemo)((function(){return n.createElement("p",{className:"box position-fixed bottom-0 end-0 small p-2 mb-0"},e?"":n.createElement("span",{className:"d-block mb-3 text-warning fw-normal"},"Please, wait for reconnection ",n.createElement("br",null),"or reaload the page"),n.createElement("span",{className:"ws-light me-2",style:{backgroundColor:e?"#199d00":"#83012f"}}),n.createElement("span",null,"WebSocket connection"),n.createElement("span",{className:"visually-hidden"},e?"online":"offline"))}),[e])}var k=r(181);k.kL.register(k.jn,k.od,k.ST,k.f$,k.uw,k.Gu,k.u);var O=function(e){return{labels:e.labels,datasets:[{label:e.name,data:e.data}]}};function D(e){var t=e.name,r=e.labels,a=e.data,o=(0,n.useRef)(null),l=(0,n.useRef)(null);return(0,n.useEffect)((function(){var e,n=null===(e=o.current)||void 0===e?void 0:e.getContext("2d");n&&(l.current=new k.kL(n,{type:"line",data:O({name:t,labels:r,data:a}),options:{responsive:!0,interaction:{intersect:!1},scales:{x:{display:!0,grid:{lineWidth:.5,borderColor:"#ffffff",drawOnChartArea:!1},ticks:{autoSkipPadding:16,maxRotation:0,font:{family:"Recursive",size:10,weight:"300"},color:"#ffffff"}},y:{display:!0,grid:{lineWidth:.5,borderColor:"#ffffff",drawOnChartArea:!1},ticks:{autoSkipPadding:16,font:{family:"Recursive",size:10,weight:"300"},color:"#ffffff"}}},elements:{line:{cubicInterpolationMode:"monotone",fill:{target:"origin",above:"rgba(255, 212, 248, 0.05)"},borderWidth:1,borderColor:"#ff00d6"},point:{radius:2,hoverRadius:4,borderColor:"#008c99",backgroundColor:"rgba(255, 255, 255, 0.4)"}},plugins:{legend:{display:!1},tooltip:{titleFont:{family:"Recursive"},bodyFont:{family:"Recursive"},displayColors:!1}},animation:{duration:0}}}))}),[]),(0,n.useEffect)((function(){l.current&&(l.current.data=O({name:t,labels:r,data:a}),l.current.update())})),n.createElement("li",{className:"box rounded p-3 mb-3"},n.createElement("h2",{className:"pb-3 text-shadow-primary"},t," - USD"),n.createElement("canvas",{className:"chart__canvas",ref:o}))}var x=function(e,t){if(e.labels.length!==t.labels.length)return!1;for(var r=0;r<=e.labels.length;r++)if(e.labels[r]!==t.labels[r])return!1;return!0},R=n.memo(D,x);function U(){var e=g().trades;return n.createElement("ul",{className:"list-reset"},Object.keys(e.currencies).map((function(t){if(e.active.has(t)){var r=e.currencies[t];return n.createElement(R,{key:t,name:r.name,labels:r.labels,data:r.data})}})))}function I(e){var t=e.symbol,r=e.name,a=e.checked,o=e.setCharts;return n.createElement("li",{className:"list-group-item me-2 mb-2"},n.createElement("input",{className:"btn-check",id:"checkbox-".concat(t),onChange:function(e){e.target.blur(),o({symbol:t,active:!a})},checked:a,type:"checkbox"}),n.createElement("label",{className:"btn btn-outline-primary",htmlFor:"checkbox-".concat(t)},r))}function _(){var e=g(),t=e.trades,r=e.dispatch.setCharts;return(0,n.useMemo)((function(){return n.createElement("form",{action:"/"},n.createElement("h3",{className:"visually-hidden"},"Choose currencies to show"),n.createElement("ul",{className:"list-group list-group-horizontal flex-wrap"},Object.keys(t.currencies).map((function(e){return n.createElement(I,{symbol:e,name:t.currencies[e].name,key:e,checked:t.active.has(e),setCharts:r})}))))}),[t.active.size])}function L(){return n.createElement(T,null,n.createElement("div",{className:"d-flex flex-column min-vh-100"},n.createElement("header",{className:"mb-3 py-1 box overflow-hidden"},n.createElement("div",{className:"marquee marquee-line"},n.createElement(N,null))),n.createElement("main",{className:"container flex-grow-1 z-index-1"},n.createElement("h1",{className:"box p-3 mb-3 rounded text-shadow-secondary"},"Cryptocurrency trades"),n.createElement("div",{className:"row row-cols-1 g-3"},n.createElement("section",{className:"col col-lg-3 mb-lg-3"},n.createElement("div",{className:"position-sticky top-1 box rounded p-3"},n.createElement("h2",{className:"pb-3 text-shadow-primary"},"Active charts"),n.createElement(_,null))),n.createElement("section",{className:"col col-lg-9"},n.createElement("h2",{className:"visually-hidden"},"Charts"),n.createElement(U,null))),n.createElement(w,null)),n.createElement("footer",{className:"box pt-2 pb-5 pb-sm-2"},n.createElement("div",{className:"container text-center"},n.createElement("a",{className:"text-shadow-secondary px-3 animate-font",href:"mailto:mareev.pv@gmail.com"},"mareev.pv@gmail.com")))))}(0,a.render)(n.createElement(L,null),document.getElementById("root"))}},function(e){e.O(0,[216],(function(){return 775,e(e.s=775)})),e.O()}]);
//# sourceMappingURL=main.3887d091ae0a8ca8a806.js.map